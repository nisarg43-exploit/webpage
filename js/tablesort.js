(function(){fdTableSort={regExp_Currency:/^[�$���]/,regExp_Number:/^(\-)?[0-9]+(\.[0-9]*)?$/,pos:-1,uniqueHash:1,thNode:null,tableId:null,tableCache:{},tmpCache:{},sortActiveClass:"sort-active",
/*@cc_on
		/*@if (@_win32)
		colspan: "colSpan",
		rowspan: "rowSpan",
		@else @*/
colspan:"colspan",rowspan:"rowspan",addEvent:function(e,a,t,r){r||(r=!0),e.attachEvent?(e["e"+a+t]=t,e[a+t]=function(){e["e"+a+t](window.event)},e.attachEvent("on"+a,e[a+t])):e.addEventListener(a,t,!0)},removeEvent:function(e,a,t,r){r||(r=!0);try{e.detachEvent?(e.detachEvent("on"+a,e[a+t]),e[a+t]=null):e.removeEventListener(a,t,!0)}catch(e){}},stopEvent:function(e){
/*@cc_on@*/
return(e=e||window.event).stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1},parseClassName:function(e,a){var t=a.className.match(new RegExp(e+"((-[\\d]+([r]){0,1})+)"));return t&&t.length?t[0].replace(e,"").split("-"):[]},disableSelection:function(e){e.onselectstart=function(){return!1},e.unselectable="on",e.style.MozUserSelect="none"},removeTableCache:function(e){if(e in fdTableSort.tableCache){fdTableSort.tableCache[e]=null,delete fdTableSort.tableCache[e];var a=document.getElementById(e);if(a)for(var t,r,l=a.getElementsByTagName("th"),o=0;r=l[o];o++)(t=r.getElementsByTagName("a")).length&&(t[0].onkeydown=t[0].onclick=null),r.onclick=r.onselectstart=r=t=null}},removeTmpCache:function(e){if(e in fdTableSort.tmpCache){for(var a,t,r=fdTableSort.tmpCache[e].headers,l=0;t=r[l];l++)for(var o,d=0;o=t[d];d++)(a=o.getElementsByTagName("a")).length&&(a[0].onkeydown=a[0].onclick=null),o.onclick=o.onselectstart=o=a=null;fdTableSort.tmpCache[e]=null,delete fdTableSort.tmpCache[e]}},initEvt:function(e){fdTableSort.init(!1)},init:function(e){if(document.getElementsByTagName&&document.createElement&&document.getElementById){var a,t,r,l,o,d,s,n,c,b,i,f,h,m,S,T,N,p,g,u,v=e&&document.getElementById(e)?[document.getElementById(e)]:document.getElementsByTagName("table"),C=document.createElement("a");C.href="#",C.className="fdTableSortTrigger";for(var w,y=document.createElement("span"),E=0;w=v[E];E++){w.id&&(fdTableSort.removeTableCache(w.id),fdTableSort.removeTmpCache(w.id)),m=w.getElementsByTagName("thead").length?w.getElementsByTagName("thead")[0].getElementsByTagName("tr"):w.getElementsByTagName("tr"),S=[],T=!1;for(var k,A=0;k=m[A];A++)if(!k.getElementsByTagName("td").length&&k.getElementsByTagName("th").length){S[S.length]=k.getElementsByTagName("th");for(var j,I=0;j=S[S.length-1][I];I++)-1!=j.className.search(/sortable/)&&(T=!0)}if(T){for(w.id||(w.id="fd-table-"+fdTableSort.uniqueHash++),s=-1==w.className.search("no-arrow"),o=-1!=w.className.search("sortable-onload-show"),n={},l=fdTableSort.parseClassName(o?"sortable-onload-show":"sortable-onload",w),d=1;d<l.length;d++)n[parseInt(l[d],10)]={reverse:-1!=l[d].search("r")};for(u=S[0].length,a=0;a<S[0].length;a++)S[0][a].getAttribute(fdTableSort.colspan)&&S[0][a].getAttribute(fdTableSort.colspan)>1&&(u+=S[0][a].getAttribute(fdTableSort.colspan)-1);for(b=new Array(S.length),a=S.length;a--;)b[a]=new Array(u);for(a=0;a<b.length;a++)for(N=0,A=0;A<u;A++)if(!b[a][A]){p=(h=S[a][N]).getAttribute(fdTableSort.colspan)>1?h.getAttribute(fdTableSort.colspan):1,g=h.getAttribute(fdTableSort.rowspan)>1?h.getAttribute(fdTableSort.rowspan):1;for(var x=0;x<p&&A+x<u;x++)for(var B=0;B<g&&a+B<b.length;B++)b[a+B][A+x]=h;if(++N==S[a].length)break}for(a=0;a<b.length;a++)for(A=0;A<b[a].length;A++)if(-1==b[a][A].className.search("fd-column-")&&-1!=b[a][A].className.search("sortable")&&(b[a][A].className=b[a][A].className+" fd-column-"+A),b[a][A].className.match("sortable")){b[a][A].className=b[a][A].className.replace(/forwardSort|reverseSort/,""),A in n&&(n[A].thNode=b[a][A],n.active=!0),i=fdTableSort.getInnerText(b[a][A],!0);for(var O=b[a][A].childNodes.length;O--;)(1!=b[a][A].childNodes[O].nodeType||"fdFilterTrigger"!=b[a][A].childNodes[O].className&&!/img/i.test(b[a][A].childNodes[O].nodeName))&&(1==b[a][A].childNodes[O].nodeType&&/^a$/i.test(b[a][A].childNodes[O].nodeName)&&(b[a][A].childNodes[O].onclick=b[a][A].childNodes[O].onkeydown=null),b[a][A].removeChild(b[a][A].childNodes[O]));(f=C.cloneNode(!0)).innerHTML=i,f.title="Sort on “"+i.replace("<br />","")+"”",f.onclick=f.onkeydown=b[a][A].onclick=fdTableSort.initWrapper,b[a][A].appendChild(f),s&&b[a][A].appendChild(y.cloneNode(!1)),b[a][A].className=b[a][A].className.replace(/fd-identical|fd-not-identical/,""),fdTableSort.disableSelection(b[a][A]),f=null}if(fdTableSort.tmpCache[w.id]={cols:u,headers:b},b=null,0,"active"in n){for(col in fdTableSort.tableId=w.id,fdTableSort.prepareTableData(document.getElementById(fdTableSort.tableId)),delete n.active,n)if("thNode"in(c=n[col])){for(fdTableSort.multi=!0,r=c.reverse?2:1,t=0;t<r;t++)fdTableSort.thNode=c.thNode,o?fdTableSort.addThNode():fdTableSort.initSort(!1,!0);o&&(fdTableSort.removeClass(c.thNode,"(forwardSort|reverseSort)"),fdTableSort.addClass(c.thNode,c.reverse?"reverseSort":"forwardSort"),s&&((y=fdTableSort.thNode.getElementsByTagName("span")[0]).firstChild&&y.removeChild(y.firstChild),y.appendChild(document.createTextNode(1==r?" ↓":" ↑"))))}o&&(fdTableSort.tableCache[w.id].colStyle||fdTableSort.tableCache[w.id].rowStyle)&&fdTableSort.redraw(w.id,!1)}else-1!=w.className.search(/onload-zebra/)&&(fdTableSort.tableId=w.id,fdTableSort.prepareTableData(w),fdTableSort.tableCache[w.id].rowStyle&&fdTableSort.redraw(w.id,!1))}}fdTableSort.thNode=f=C=y=n=thNode=w=m=S=null}},initWrapper:function(e){var a="keydown"==(e=e||window.event).type?null!=e.keyCode?e.keyCode:e.charCode:-1;if(null==fdTableSort.thNode&&("click"==e.type||13==a)){for(var t=this;"th"!=t.tagName.toLowerCase();)t=t.parentNode;for(fdTableSort.thNode=t;"table"!=t.tagName.toLowerCase();)t=t.parentNode;return fdTableSort.tableId=t.id,fdTableSort.multi=e.shiftKey,fdTableSort.addSortActiveClass(),setTimeout(fdTableSort.initSort,5,!1),fdTableSort.stopEvent(e)}return-1!=a||fdTableSort.stopEvent(e)},jsWrapper:function(e,a){if(!(e in fdTableSort.tmpCache))return!1;e in fdTableSort.tableCache||fdTableSort.prepareTableData(document.getElementById(e)),a instanceof Array||(a=[a]),fdTableSort.tableId=e;var t,r=a.length;if(fdTableSort.tableCache[e].thList.length==a.length){for(var l,o=!0,d=0;d<r;d++)if(t=a[d],(l=fdTableSort.tmpCache[e].headers[0][t])!=fdTableSort.tableCache[e].thList[d]){o=!1;break}if(o)return fdTableSort.thNode=l,void fdTableSort.initSort(!0)}fdTableSort.addSortActiveClass();for(d=0;d<r;d++)fdTableSort.multi=d,t=a[d],fdTableSort.thNode=fdTableSort.tmpCache[e].headers[0][t],fdTableSort.initSort(!0)},addSortActiveClass:function(){null!=fdTableSort.thNode&&(fdTableSort.addClass(fdTableSort.thNode,fdTableSort.sortActiveClass),fdTableSort.addClass(document.getElementsByTagName("body")[0],fdTableSort.sortActiveClass))},removeSortActiveClass:function(){null!=fdTableSort.thNode&&(fdTableSort.removeClass(fdTableSort.thNode,fdTableSort.sortActiveClass),fdTableSort.removeClass(document.getElementsByTagName("body")[0],fdTableSort.sortActiveClass))},doCallback:function(e){fdTableSort.tableId&&fdTableSort.tableId in fdTableSort.tableCache&&fdTableSort.callback(fdTableSort.tableId,e?fdTableSort.tableCache[fdTableSort.tableId].initiatedCallback:fdTableSort.tableCache[fdTableSort.tableId].completeCallback)},addClass:function(e,a){new RegExp("(^|\\s)"+a+"(\\s|$)").test(e.className)||(e.className+=(e.className?" ":"")+a)},
/*@cc_on
		/*@if (@_win32)
		removeClass: function(e, c) {
			e.className = !c ? "" : e.className.replace(new RegExp("(^|\\s)" + c + "(\\s|$)"), " ").replace(/^\s*((?:[\S\s]*\S)?)\s*$/, '$1');
		},
		@else @*/
removeClass:function(e,a){e.className=a?e.className.replace(new RegExp("(^|\\s)"+a+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},callback:function(e,a){var t,r;try{if(-1!=a.indexOf(".")){r=a.split("."),obj=window;for(var l,o=0;l=obj[r[o]];o++)l instanceof Function?function(){var e=l;t=function(a){e.apply(obj,[a])}}():obj=l}else t=a+e in window?window[a+e]:a in window?window[a]:null}catch(e){}t instanceof Function&&t(e,fdTableSort.tableCache[e].thList)},prepareTableData:function(e){for(var a,t,r,l,o,d,s=[],n=e.getElementsByTagName("tbody"),c=(n=n.length?n[0]:e).rows,b=e.getElementsByTagName("th"),i=c.length,f=fdTableSort.tmpCache[e.id].cols,h=(s=[],new Array(f)),m=new Array(f),S=0;S<f;S++)h[S]=!0;var T=new RegExp(/fd-column-([0-9]+)/),N=0,p=[];for(S=0;g=b[S];S++)-1!=g.className.search(T)&&(p[p.length]=g);for(d=0;d<i;d++)if(!((a=c[d]).parentNode!=n||a.getElementsByTagName("th").length||a.parentNode&&-1!=a.parentNode.tagName.toLowerCase().search(/thead|tfoot/))){s[N]=[],l=a.cells;var g;for(S=0;g=p[S];S++)t=l[o=g.className.match(T)[1]],r=(r=fdTableSort.getInnerText(t)+" ").replace(/^\s+/,"").replace(/\s+$/,""),-1!=g.className.search(/sortable-date/)?r=fdTableSort.dateFormat(r,-1!=g.className.search(/sortable-date-dmy/)):-1!=g.className.search(/sortable-numeric|sortable-currency/)?(r=parseFloat(r.replace(/[^0-9\.\-]/g,"")),isNaN(r)&&(r="")):-1!=g.className.search(/sortable-text/)?r=r.toLowerCase():-1!=g.className.search(/sortable-keep/)?r=N:-1!=g.className.search(/sortable-([a-zA-Z\_]+)/)?g.className.match(/sortable-([a-zA-Z\_]+)/)[1]+"PrepareData"in window&&(r=window[g.className.match(/sortable-([a-zA-Z\_]+)/)[1]+"PrepareData"](t,r)):""!=r&&(fdTableSort.removeClass(g,"sortable"),0!=fdTableSort.dateFormat(r)?(fdTableSort.addClass(g,"sortable-date"),r=fdTableSort.dateFormat(r)):-1!=r.search(fdTableSort.regExp_Number)||-1!=r.search(fdTableSort.regExp_Currency)?(fdTableSort.addClass(g,"sortable-numeric"),r=parseFloat(r.replace(/[^0-9\.\-]/g,"")),isNaN(r)&&(r="")):(fdTableSort.addClass(g,"sortable-text"),r=r.toLowerCase())),N>0&&h[o]&&m[o]!=r&&(h[o]=!1),m[o]=r,s[N][o]=r;s[N][f]=a,N++}var u=-1!=e.className.search(/colstyle-([\S]+)/)&&e.className.match(/colstyle-([\S]+)/)[1],v=-1!=e.className.search(/rowstyle-([\S]+)/)&&e.className.match(/rowstyle-([\S]+)/)[1],C=-1==e.className.search(/sortinitiatedcallback-([\S-]+)/)?"sortInitiatedCallback":e.className.match(/sortinitiatedcallback-([\S]+)/)[1],w=-1==e.className.search(/sortcompletecallback-([\S-]+)/)?"sortCompleteCallback":e.className.match(/sortcompletecallback-([\S]+)/)[1];C=C.replace("-","."),w=w.replace("-","."),fdTableSort.tableCache[e.id]={hook:n,initiatedCallback:C,completeCallback:w,thList:[],colOrder:{},data:s,identical:h,colStyle:u,rowStyle:v,noArrow:-1!=e.className.search(/no-arrow/)},p=s=a=t=g=c=h=m=null},onUnload:function(){for(tbl in fdTableSort.tableCache)fdTableSort.removeTableCache(tbl);for(tbl in fdTableSort.tmpCache)fdTableSort.removeTmpCache(tbl);fdTableSort.removeEvent(window,"load",fdTableSort.initEvt),fdTableSort.removeEvent(window,"unload",fdTableSort.onUnload),fdTableSort.tmpCache=fdTableSort.tableCache=null},addThNode:function(){var e=fdTableSort.tableCache[fdTableSort.tableId],a=fdTableSort.thNode.className.match(/fd-column-([0-9]+)/)[1],t=!1;if(!fdTableSort.multi){if(e.colStyle)for(var r=e.thList.length,l=0;l<r;l++)e.colOrder[e.thList[l].className.match(/fd-column-([0-9]+)/)[1]]=!1;e.thList.length&&e.thList[0]==fdTableSort.thNode&&(t=!0),e.thList=[]}var o=!1;for(e.thList.length,l=0;n=e.thList[l];l++)if(n==fdTableSort.thNode){o=!0;break}o||(e.thList.push(fdTableSort.thNode),e.colStyle&&(e.colOrder[a]=!0));var d,s=document.getElementById(fdTableSort.tableId).getElementsByTagName("th");for(l=0;d=s[l];l++){o=!1;for(var n,c=0;n=e.thList[c];c++)if(n==d){o=!0;break}if(!o&&(fdTableSort.removeClass(d,"(forwardSort|reverseSort)"),!e.noArrow&&(span=d.getElementsByTagName("span"),span.length)))for(span=span[0];span.firstChild;)span.removeChild(span.firstChild)}e.thList.length>1?(classToAdd=-1!=fdTableSort.thNode.className.search(/forwardSort/)?"reverseSort":"forwardSort",fdTableSort.removeClass(fdTableSort.thNode,"(forwardSort|reverseSort)"),fdTableSort.addClass(fdTableSort.thNode,classToAdd),e.pos=-1):t&&(e.pos=fdTableSort.thNode)},initSort:function(noCallback,ident){var thNode=fdTableSort.thNode,tableElem=document.getElementById(fdTableSort.tableId);fdTableSort.tableId in fdTableSort.tableCache||fdTableSort.prepareTableData(document.getElementById(fdTableSort.tableId)),fdTableSort.addThNode(),noCallback||fdTableSort.doCallback(!0),fdTableSort.pos=thNode.className.match(/fd-column-([0-9]+)/)[1];var dataObj=fdTableSort.tableCache[tableElem.id],lastPos=dataObj.pos&&dataObj.pos.className?dataObj.pos.className.match(/fd-column-([0-9]+)/)[1]:-1,len1=dataObj.data.length,len2=dataObj.data.length>0?dataObj.data[0].length-1:0,identical=dataObj.identical[fdTableSort.pos],classToAdd="forwardSort";if(dataObj.thList.length>1){for(var js="var sortWrapper = function(a,b) {\n",l=dataObj.thList.length,cnt=0,e,d,th,p,f,i=0;i<l;i++)th=dataObj.thList[i],p=th.className.match(/fd-column-([0-9]+)/)[1],dataObj.identical[p]||(cnt++,f=th.className.match(/sortable-(numeric|currency|date|keep)/)?"fdTableSort.sortNumeric":th.className.match("sortable-text")?"fdTableSort.sortText":-1!=th.className.search(/sortable-([a-zA-Z\_]+)/)&&th.className.match(/sortable-([a-zA-Z\_]+)/)[1]in window?"window['"+th.className.match(/sortable-([a-zA-Z\_]+)/)[1]+"']":"fdTableSort.sortText",e="e"+i,d=-1!=th.className.search("forwardSort")?"a,b":"b,a",js+="fdTableSort.pos   = "+p+";\n",js+="var "+e+" = "+f+"("+d+");\n",js+="if("+e+") return "+e+";\n",js+="else { \n");js+="return 0;\n";for(var i=0;i<cnt;i++)js+="};\n";cnt&&(js+="return 0;\n"),js+="};\n",eval(js),dataObj.data.sort(sortWrapper),identical=!1}else lastPos==fdTableSort.pos&&!identical||-1!=thNode.className.search(/sortable-keep/)&&-1==lastPos?(dataObj.data.reverse(),classToAdd=-1!=thNode.className.search(/reverseSort/)?"forwardSort":"reverseSort",-1!=thNode.className.search(/sortable-keep/)&&-1==lastPos&&(fdTableSort.tableCache[tableElem.id].pos=thNode)):(fdTableSort.tableCache[tableElem.id].pos=thNode,classToAdd=-1!=thNode.className.search(/forwardSort/)?"reverseSort":"forwardSort",identical||(thNode.className.match(/sortable-(numeric|currency|date|keep)/)?dataObj.data.sort(fdTableSort.sortNumeric):thNode.className.match("sortable-text")?dataObj.data.sort(fdTableSort.sortText):-1!=thNode.className.search(/sortable-([a-zA-Z\_]+)/)&&thNode.className.match(/sortable-([a-zA-Z\_]+)/)[1]in window&&dataObj.data.sort(window[thNode.className.match(/sortable-([a-zA-Z\_]+)/)[1]]),-1!=thNode.className.search(/(^|\s)favour-reverse($|\s)/)&&(classToAdd="forwardSort"==classToAdd?"reverseSort":"forwardSort",dataObj.data.reverse())));if(ident&&(identical=!1),1==dataObj.thList.length&&(fdTableSort.removeClass(thNode,"(forwardSort|reverseSort)"),fdTableSort.addClass(thNode,classToAdd)),!dataObj.noArrow){var span=fdTableSort.thNode.getElementsByTagName("span")[0];span.firstChild&&span.removeChild(span.firstChild),span.appendChild(document.createTextNode(-1!=fdTableSort.thNode.className.search(/forwardSort/)?" ↓":" ↑"))}if(!dataObj.rowStyle&&!dataObj.colStyle&&identical)return fdTableSort.removeSortActiveClass(),noCallback||fdTableSort.doCallback(!1),void(fdTableSort.thNode=null);"tablePaginater"in window&&tablePaginater.tableIsPaginated(fdTableSort.tableId)?tablePaginater.redraw(fdTableSort.tableId,identical):fdTableSort.redraw(fdTableSort.tableId,identical),fdTableSort.removeSortActiveClass(),noCallback||fdTableSort.doCallback(!1),fdTableSort.thNode=null},redraw:function(e,a){if(e&&e in fdTableSort.tableCache){for(var t,r,l=fdTableSort.tableCache[e],o=l.data,d=o.length,s=d?o[0].length-1:0,n=l.hook,c=l.colStyle,b=l.rowStyle,i=l.colOrder,f=0,h=/(^|\s)invisibleRow(\s|$)/,m=0;m<d;m++){if(t=o[m][s],c)for(thPos in r=t.cells,i)i[thPos]?fdTableSort.addClass(r[thPos],c):fdTableSort.removeClass(r[thPos],c);a||(b&&-1==t.className.search(h)&&(1&f++?fdTableSort.addClass(t,b):fdTableSort.removeClass(t,b)),n.appendChild(t))}t=r=n=null}},getInnerText:function(e,a){if("string"==typeof e||void 0===e)return e;if(e.innerText)return e.innerText;var t,r="";for(t=e.firstChild;t;t=t.nextSibling)a&&t.nodeName&&"BR"==t.nodeName?r+="<br />":3==t.nodeType?r+=t.nodeValue:1==t.nodeType&&(r+=fdTableSort.getInnerText(t));return r},dateFormat:function(e,a){for(var t,r=[{regExp:/^(0?[1-9]|1[012])([- \/.])(0?[1-9]|[12][0-9]|3[01])([- \/.])((\d\d)?\d\d)$/,d:3,m:1,y:5},{regExp:/^(0?[1-9]|[12][0-9]|3[01])([- \/.])(0?[1-9]|1[012])([- \/.])((\d\d)?\d\d)$/,d:1,m:3,y:5},{regExp:/^(\d\d\d\d)([- \/.])(0?[1-9]|1[012])([- \/.])(0?[1-9]|[12][0-9]|3[01])$/,d:5,m:3,y:1}],l=0,o=r.length;l<o;){if(t=(l+(a?o+1:o))%o,e.match(r[t].regExp))return res=e.match(r[t].regExp),y=res[r[t].y],m=res[r[t].m],d=res[r[t].d],1==m.length&&(m="0"+String(m)),1==d.length&&(d="0"+String(d)),4!=y.length&&(y=parseInt(y)<50?"20"+String(y):"19"+String(y)),y+String(m)+d;l++}return 0},sortNumeric:function(e,a){var t=e[fdTableSort.pos],r=a[fdTableSort.pos];return t==r?0:""!==t||isNaN(r)?""!==r||isNaN(t)?t-r:1:-1},sortText:function(e,a){var t=e[fdTableSort.pos],r=a[fdTableSort.pos];return t==r?0:t<r?-1:1}}})(),fdTableSort.addEvent(window,"load",fdTableSort.initEvt),fdTableSort.addEvent(window,"unload",fdTableSort.onUnload);